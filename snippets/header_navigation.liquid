{% assign submenu = l.title | handleize %}

{% if settings.megamenu_items_1 == l.title or settings.megamenu_items_2 == l.title %}
<li class="{% if l.active %}active {% endif %}dropdown mega-menu">
  <a href="{{ l.url }}" class="dropdown-toggle dropdown-link" data-toggle="dropdown">
    <span>{{ l.title }}</span>
    <i class="fa fa-angle-down"></i>
    <i class="sub-dropdown1 visible-sm visible-md visible-lg"></i>
    <i class="sub-dropdown visible-sm visible-md visible-lg"></i>
  </a>
  {% if settings.megamenu_items_1 == l.title %}  
  <div class="megamenu-container col-4 megamenu-container-1 dropdown-menu" {% if settings.display_menu_image_1 %} style="background-image:url({{ 'mega-bg-01.png' | asset_url }})"{% endif %}>
    <ul class="sub-mega-menu">
      {% if settings.mega_linklist_1 != "" %}
      <li class="mega1-collumn1 col-sm-3">
        {% assign list = linklists[settings.mega_linklist_1] %}
        <ul>
          <li class="list-title">{{ list.title }}</li>
          {% for link in list.links %}
          <li class="list-unstyled li-sub-mega">
            <a href="{{ link.url }}">{{ link.title | escape }}</a>           
          </li>
          {% endfor %}
        </ul>
      </li>
      {% endif %}
      {% if settings.mega_linklist_2 != "" %}
      <li class="mega1-collumn2 col-sm-3">
        {% assign list = linklists[settings.mega_linklist_2] %}
        <ul>
          <li class="list-title">{{ list.title }}</li>
          {% for link in list.links %}
          <li class="list-unstyled li-sub-mega">
            <a href="{{ link.url }}">{{ link.title | escape }}</a>           
          </li>
          {% endfor %}
        </ul>
      </li>
      {% endif %}
      {% if settings.mega_linklist_3 != "" %}
      <li class="mega1-collumn3 col-sm-3">
        {% assign list = linklists[settings.mega_linklist_3] %}
        <ul>
          <li class="list-title">{{ list.title }}</li>
          {% for link in list.links %}
          <li class="list-unstyled li-sub-mega">
            <a href="{{ link.url }}">{{ link.title | escape }}</a>           
          </li>
          {% endfor %}
        </ul>
      </li>
      {% endif %}
      {% if settings.mega_linklist_4 != "" %}
      <li class="mega1-collumn4 col-sm-3">
        {% assign list = linklists[settings.mega_linklist_4] %}
        <ul>
          <li class="list-title">{{ list.title }}</li>
          {% for link in list.links %}
          <li class="list-unstyled li-sub-mega">
            <a href="{{ link.url }}">{{ link.title | escape }}</a>           
          </li>
          {% endfor %}
        </ul>
      </li>
      {% endif %}
    </ul>
    <script>
      $(window).ready(function($) {
        $('.megamenu-container-1').css("width",$('.main-header-inner').innerWidth());
      });
      $( window ).resize(function() {
        $('.megamenu-container-1').css("width",$('.main-header-inner').innerWidth());
      });
    </script>
  </div>  
  {% elsif settings.megamenu_items_2 == l.title %}
  <div class="megamenu-container megamenu-container-2 dropdown-menu" {% if settings.display_menu_image_1 %} style="background-image:url({{ 'mega-bg-02.png' | asset_url }})"{% endif %}>
    <ul class="sub-mega-menu">
      {% if settings.mega_linklist_5 != "" %}
      <li class="mega2-collumn1 col-sm-2">
        {% assign list = linklists[settings.mega_linklist_5] %}
        <ul>
          <li class="list-title">{{ list.title }}</li>
          {% for link in list.links %}
          <li class="list-unstyled li-sub-mega">
            <a href="{{ link.url }}">{{ link.title | escape }}</a>           
          </li>
          {% endfor %}
        </ul>
      </li>
      {% endif %}
      <li class="mega2-column2 col-sm-5">
        <div class="col-image col-sm-6"><img src="{{ 'mega2-col1-img.jpg' | asset_url }}" alt="" /></div>
        <div class="col-text col-sm-6">{{ settings.mega2-col1-text }}</div>
      </li>
      <li class="mega2-column2 col-sm-5">
        <div class="col-image col-sm-6"><img src="{{ 'mega2-col2-img.jpg' | asset_url }}" alt="" /></div>
        <div class="col-text col-sm-6">{{ settings.mega2-col2-text }}</div>
      </li>
    </ul>
    <script>
      $(window).ready(function($) {
        $('.megamenu-container-2').css("width",$('.main-header-inner').innerWidth());
      });
      $( window ).resize(function() {
        $('.megamenu-container-2').css("width",$('.main-header-inner').innerWidth());
      });
    </script>
  </div>
  {% endif %}
</li>

{% else %}

{% if linklists[submenu].links.size > 0 %}
<li class="nav-item{% if l.active %} active{% endif %} dropdown navigation">
  <a href="{{ l.url }}" class="dropdown-toggle dropdown-link" data-toggle="dropdown">
    <span>{{ l.title }}</span>
    <i class="fa fa-angle-down"></i>
    <i class="sub-dropdown1  visible-sm visible-md visible-lg"></i>
    <i class="sub-dropdown visible-sm visible-md visible-lg"></i>
  </a>
  <ul class="dropdown-menu">
    <li class="list-title">{{ l.title }}</li>
    {% for l in linklists[submenu].links %}
    {% include 'navigation_sub-links' with forloop.index %}
    {% endfor %}
  </ul>
</li>
{% else %}
<li class="nav-item{% if l.active %} active{% endif %}">
  <a href="{{ l.url }}">
    <span>{{ l.title }}</span>
  </a>
</li>
{% endif %}
{% endif %}